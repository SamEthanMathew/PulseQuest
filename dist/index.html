<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" name=viewport><meta content=yes name=mobile-web-app-capable><meta content=yes name=apple-mobile-web-app-capable><meta content=black-fullscreen name=apple-mobile-web-app-status-bar-style><meta content=landscape name=screen-orientation><title>‚üÅ PulseQuest</title><style>:root{--bg:#070a16;--card:#0f1420;--text:#e8edf5;--stroke:#1e2738;--accent:#6ca8ff;--beacon:#ffd166;--empty:#1a2332}*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--bg);color:var(--text);overflow:hidden;width:100vw;height:100vh;display:flex;align-items:center;justify-content:center}.shell{width:100%;height:100%;display:flex;flex-direction:column;padding:10px}.card{flex:1;display:flex;flex-direction:column;background:var(--card);border:1px solid var(--stroke);border-radius:12px;overflow:hidden;position:relative;width:100%;height:100%}.hud{display:flex;align-items:center;justify-content:space-between;padding:12px 20px;border-bottom:1px solid var(--stroke);background:rgba(0,0,0,.3);gap:20px}.hud-left{display:flex;align-items:center;gap:16px}.hud-center{display:flex;align-items:center;gap:20px}.title{font-size:20px;font-weight:800;color:var(--beacon)}.info{font-size:14px;color:var(--text)}.stage{flex:1;padding:20px;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;touch-action:none;min-height:0}#grid{width:min(100%,90vw);height:auto;max-height:min(600px,70vh);aspect-ratio:14/4;display:grid;grid-template-columns:repeat(14,1fr);gap:clamp(1px,.2vw,3px);padding:clamp(2px,.3vw,4px);background:rgba(0,0,0,.6);border:2px solid var(--stroke);border-radius:8px}.cell{width:100%;height:100%;aspect-ratio:1;min-width:18px;min-height:18px;max-width:40px;max-height:40px;border-radius:clamp(2px,.3vw,4px);display:flex;align-items:center;justify-content:center;position:relative;background:var(--empty);border:1px solid rgba(255,255,255,.08);font-size:clamp(16px, 2.5vw, 24px)}@media (max-width:768px){#grid{max-height:min(400px,60vh)}.cell{min-width:16px;min-height:16px;max-width:28px;max-height:28px}}@media (min-width:1200px){#grid{max-height:min(700px,75vh)}.cell{max-width:45px;max-height:45px}}.cell.beacon{background:#3d2f1a;border-color:rgba(255,209,102,.35)}.cell.wall{background:#2a3142;border-color:rgba(255,255,255,.08)}.player{font-size:18px;filter:drop-shadow(0 2px 4px rgba(0, 0, 0, .5))}.icon{font-size:18px}.compass{width:60px;height:60px;background:rgba(0,0,0,.6);border:2px solid var(--stroke);border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px rgba(0,0,0,.3)}.compass-inner{position:relative;width:45px;height:45px}.compass-arrow{position:absolute;font-size:12px;opacity:.3;transition:opacity .3s,transform .3s}.compass-arrow.active{opacity:1;color:#ffd166;transform:scale(1.3);filter:drop-shadow(0 0 8px #ffd166)}.compass-arrow.n{top:0;left:50%;transform:translateX(-50%)}.compass-arrow.n.active{transform:translateX(-50%) scale(1.3)}.compass-arrow.e{top:50%;right:0;transform:translateY(-50%)}.compass-arrow.e.active{transform:translateY(-50%) scale(1.3)}.compass-arrow.s{bottom:0;left:50%;transform:translateX(-50%)}.compass-arrow.s.active{transform:translateX(-50%) scale(1.3)}.compass-arrow.w{top:50%;left:0;transform:translateY(-50%)}.compass-arrow.w.active{transform:translateY(-50%) scale(1.3)}.drawer{position:absolute;top:0;right:0;bottom:0;width:280px;background:rgba(10,15,30,.98);border-left:1px solid var(--stroke);z-index:1000;transform:translateX(100%);transition:transform .4s cubic-bezier(.16, 1, .3, 1);display:flex;flex-direction:column;backdrop-filter:blur(24px);box-shadow:-20px 0 50px rgba(0,0,0,.8)}.drawer.open{transform:translateX(0)}.drawer-header{padding:24px 20px 10px;display:flex;align-items:center;justify-content:space-between}.drawer h3{font-size:20px;color:var(--beacon);font-weight:800;margin:0}.close-btn{background:rgba(255,255,255,.05);border:none;color:#fff;width:36px;height:36px;border-radius:50%;font-size:24px;cursor:pointer;display:flex;align-items:center;justify-content:center}.settings{flex:1;display:flex;flex-direction:column;gap:14px;padding:20px;overflow-y:auto}.settings label,.settings select{width:100%;text-align:left;font-size:14px;background:linear-gradient(135deg,rgba(255,255,255,.08),rgba(255,255,255,.03));padding:16px;border-radius:12px;border:1px solid var(--stroke);color:var(--text);cursor:pointer;transition:all .2s;font-weight:500}.settings select:hover{background:linear-gradient(135deg,rgba(255,255,255,.12),rgba(255,255,255,.06));border-color:var(--accent);transform:translateY(-1px)}.settings select:focus{outline:0;border-color:var(--accent);box-shadow:0 0 0 3px rgba(108,168,255,.1)}.settings select option{background:#0f1420;color:var(--text);padding:10px}.menu-btn{background:linear-gradient(135deg,rgba(255,255,255,.08),rgba(255,255,255,.03));border:1px solid var(--stroke);color:var(--text);padding:8px 12px;border-radius:8px;cursor:pointer;font-size:16px;font-weight:600;transition:all .2s;display:inline-flex;align-items:center;gap:6px}.menu-btn:hover{background:linear-gradient(135deg,rgba(255,255,255,.12),rgba(255,255,255,.06));border-color:var(--accent);transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,.3)}.menu-btn:active{transform:translateY(0)}.sonar-blinkers{display:flex;gap:16px;padding:10px 20px;background:rgba(0,0,0,.6);border-radius:99px;border:2px solid var(--stroke)}.sonar-led{width:24px;height:24px;border-radius:50%;background:rgba(255,255,255,.15);border:2px solid rgba(255,255,255,.3);transition:all .15s;position:relative}.sonar-led::before{content:'';position:absolute;inset:-6px;border-radius:50%;background:radial-gradient(circle,var(--accent) 0,transparent 70%);opacity:0;transition:opacity .15s}.sonar-led.active{background:var(--accent);border-color:var(--accent);box-shadow:0 0 24px var(--accent),inset 0 0 12px rgba(255,255,255,.5)}.sonar-led.active::before{opacity:.7}.sonar-led.long{background:var(--beacon);border-color:var(--beacon);box-shadow:0 0 24px var(--beacon),inset 0 0 12px rgba(255,255,255,.5)}.controls-panel{background:rgba(0,0,0,.4);border-top:1px solid var(--stroke);padding:16px 20px;display:flex;justify-content:center;gap:40px;flex-wrap:wrap}.control-item{display:flex;align-items:center;gap:8px;font-size:13px;color:rgba(255,255,255,.8)}.control-key{background:rgba(255,255,255,.1);border:1px solid var(--stroke);border-radius:4px;padding:4px 8px;font-weight:600;font-size:12px;color:var(--accent);min-width:60px;text-align:center}#overlay{position:absolute;inset:0;background:rgba(7,10,22,.95);backdrop-filter:blur(20px);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:100;cursor:pointer}#overlay.hidden{display:none}#overlay h2{font-size:48px;margin-bottom:10px;color:var(--beacon)}#overlay p{font-size:14px;color:var(--accent)}#win{position:absolute;inset:0;background:rgba(7,10,22,.95);backdrop-filter:blur(20px);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:100}#win.hidden{display:none}#win h2{font-size:64px;margin-bottom:20px}</style></head><body><div class=shell><div class=card><div class=hud><div class=hud-left><div class=title>‚üÅ PulseQuest</div></div><div class=hud-center><div class=compass><div class=compass-inner><div class="compass-arrow n" id=compass-n>‚ñ≤</div><div class="compass-arrow e" id=compass-e>‚ñ∫</div><div class="compass-arrow s" id=compass-s>‚ñº</div><div class="compass-arrow w" id=compass-w>‚óÄ</div></div></div><div class=sonar-blinkers><div class=sonar-led id=led-left></div><div class=sonar-led id=led-right></div></div></div><div class=info>Pos: <span id=pos>1,1</span> | Dir: <span id=dir>E</span> | Steps: <span id=steps>0</span> <button class=menu-btn onclick=toggleDrawer() style=margin-left:15px>üó∫Ô∏è</button></div></div><div class=stage id=stage><div id=grid></div><div class=scan-overlay id=scanOverlay><h3>üì° Distance Scan</h3><div class=scan-data><div class=scan-item><div class=scan-label>X Distance</div><div class=scan-value id=scanX>0</div></div><div class=scan-item><div class=scan-label>Y Distance</div><div class=scan-value id=scanY>0</div></div></div></div></div><div class=controls-panel><div class=control-item><span class=control-key>Tap Left</span> <span>Move Forward</span></div><div class=control-item><span class=control-key>Tap Right</span> <span>Turn Right 90¬∞</span></div><div class=control-item><span class=control-key>Hold Both</span> <span>Sonar Scan</span></div><div class=control-item><span class=control-key>W / ‚Üë</span> <span>Move (Desktop)</span></div><div class=control-item><span class=control-key>D / ‚Üí</span> <span>Turn (Desktop)</span></div></div><div class=drawer id=drawer><div class=drawer-header><h3>Settings</h3><button class=close-btn onclick=toggleDrawer()>√ó</button></div><div class=settings><select id=mapSelect onchange=loadMap()><option value=0>Map: Empty</option><option value=1>Map: Simple Maze</option><option value=2>Map: Challenge</option></select></div></div></div></div><div id=overlay><h2>‚üÅ PulseQuest</h2><p>Tap to begin</p></div><div class=hidden id=win><h2>ü•á</h2><p>Treat found! You have saved the world!!</p><div style=margin-top:20px><select id=winMapSelect onchange=loadMapFromWin() style="padding:10px 20px;font-size:14px;border-radius:8px;background:rgba(255,255,255,.1);border:1px solid var(--stroke);color:var(--text);cursor:pointer"><option value=0>Map: Empty</option><option value=1>Map: Simple Maze</option><option value=2>Map: Challenge</option></select></div></div><script>const WIDTH=14,HEIGHT=4,DIR=["N","E","S","W"],DX=[0,1,0,-1],DY=[-1,0,1,0],COMPASS_IDS=["compass-n","compass-e","compass-s","compass-w"],MAPS=["EEEEEEEEEEEEEE,EEEEEEEEEEEEEE,EEEEEEEEEEBEEE,EEEEEEEEEEEEEE","WWWWWWWWWWWWWW,WEEEEWWWEEEEEW,WEWWWWWWEWWWEW,WEEEEEEEEWWBEW","WWWWWWWWWWWWWW,WEEEEWEEEEEEEW,WEWWWWWWEWWBEW,WEEEEEEEEEEEEW"];let map=[],px=1,py=1,pd=1,steps=0,started=!1,beaconX=19,beaconY=5;function parseMap(e){return e.split(",").map(e=>e.split(""))}function getTile(e,t){return t>=0&&t<4&&e>=0&&e<14?map[t][e]:"W"}function render(){const e=document.getElementById("grid");e.innerHTML="";for(let t=0;t<4;t++)for(let n=0;n<14;n++){const o=document.createElement("div"),s=map[t][n];o.className="cell","B"===s?(o.classList.add("beacon"),o.innerHTML='<span class="icon">ü¶¥</span>'):"W"===s&&(o.classList.add("wall"),o.innerHTML='<span class="icon">üß±</span>'),n===px&&t===py&&(o.innerHTML='<span class="player">üêï</span>'),e.appendChild(o)}COMPASS_IDS.forEach((e,t)=>{const n=document.getElementById(e);n&&n.classList.toggle("active",t===pd)}),document.getElementById("pos").textContent=`${px},${py}`,document.getElementById("dir").textContent=DIR[pd],document.getElementById("steps").textContent=steps}function moveForward(){if(!started)return;const e=px+DX[pd],t=py+DY[pd];if(e<0||e>=14||t<0||t>=4)return;const n=getTile(e,t);"W"!==n&&(px=e,py=t,steps++,"B"===n&&document.getElementById("win").classList.remove("hidden"),render())}function turnRight(){started&&(pd=(pd+1)%4,render())}function performScan(){if(!started)return;const e=beaconX-px,t=beaconY-py;document.getElementById("scanX").textContent=Math.abs(e),document.getElementById("scanY").textContent=Math.abs(t);const n=document.getElementById("scanOverlay");n.classList.add("active");let o,s=180*Math.atan2(t,e)/Math.PI-[0,90,180,-90][pd];for(;s>180;)s-=360;for(;s<-180;)s+=360;o=Math.abs(s)<=25?"ahead":Math.abs(s)>=155?"behind":s>0?"right":"left";const a=Math.abs(e)+Math.abs(t);let d;d=a<=1?5:a<=3?4:a<=6?3:a<=10?2:1,performSonarBlinks(o,d),setTimeout(()=>{n.classList.remove("active")},2e3)}function performSonarBlinks(e,t){const n=document.getElementById("led-left"),o=document.getElementById("led-right");let s=[];"left"===e?s.push({leds:[n],duration:150,gap:400}):"right"===e?s.push({leds:[o],duration:150,gap:400}):"ahead"===e?s.push({leds:[n,o],duration:150,gap:400}):"behind"===e&&(s.push({leds:[n,o],duration:300,gap:150,long:!0}),s.push({leds:[n,o],duration:300,gap:400,long:!0}));for(let e=0;e<t;e++){const a=e===t-1;s.push({leds:[n,o],duration:150,gap:a?0:200})}let a=0;s.forEach(e=>{setTimeout(()=>{e.leds.forEach(t=>{t.classList.add("active"),e.long&&t.classList.add("long")}),setTimeout(()=>{e.leds.forEach(t=>{t.classList.remove("active"),e.long&&t.classList.remove("long")})},e.duration)},a),a+=e.duration+e.gap})}function loadMap(){const e=parseInt(document.getElementById("mapSelect").value);map=parseMap(MAPS[e]);for(let e=0;e<4;e++)for(let t=0;t<14;t++)"B"===map[e][t]&&(beaconX=t,beaconY=e);px=1,py=1,pd=1,steps=0,document.getElementById("win").classList.add("hidden"),render()}function loadMapFromWin(){const e=parseInt(document.getElementById("winMapSelect").value);document.getElementById("mapSelect").value=e,loadMap()}function toggleDrawer(){document.getElementById("drawer").classList.toggle("open")}let touchTimeout=null,wasHeld=!1;const stageEl=document.getElementById("stage"),activePointers=new Map;let leftTouch=!1,rightTouch=!1;function showFlash(e,t){const n=document.createElement("div");n.className="input-flash",n.style.left=e+"px",n.style.top=t+"px",document.body.appendChild(n),setTimeout(()=>n.remove(),400)}function updateTouchZones(){const e=stageEl.getBoundingClientRect(),t=e.left+e.width/2;leftTouch=!1,rightTouch=!1,activePointers.forEach(e=>{e.x<t?leftTouch=!0:rightTouch=!0})}function start(){document.getElementById("overlay").classList.add("hidden"),started=!0;const e=document.documentElement;e.requestFullscreen?e.requestFullscreen().catch(e=>console.log("Fullscreen failed:",e)):e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),loadMap()}stageEl.addEventListener("pointerdown",e=>{started&&(e.preventDefault(),stageEl.setPointerCapture(e.pointerId),wasHeld=!1,activePointers.set(e.pointerId,{x:e.clientX,y:e.clientY}),updateTouchZones(),showFlash(e.clientX,e.clientY),leftTouch&&rightTouch&&(clearTimeout(touchTimeout),touchTimeout=setTimeout(()=>{wasHeld=!0,performScan()},300)))},{passive:!1}),stageEl.addEventListener("pointerup",e=>{if(!activePointers.has(e.pointerId))return;try{stageEl.releasePointerCapture(e.pointerId)}catch{}const t=stageEl.getBoundingClientRect(),n=t.left+t.width/2,o=activePointers.get(e.pointerId).x;activePointers.delete(e.pointerId),clearTimeout(touchTimeout),updateTouchZones(),0!==activePointers.size||wasHeld||(o<n?moveForward():turnRight())}),stageEl.addEventListener("pointercancel",e=>{try{stageEl.releasePointerCapture(e.pointerId)}catch{}activePointers.delete(e.pointerId),clearTimeout(touchTimeout),updateTouchZones()}),document.addEventListener("keydown",e=>{"w"===e.key||"ArrowUp"===e.key?moveForward():"d"!==e.key&&"ArrowRight"!==e.key||turnRight()}),document.getElementById("overlay").addEventListener("pointerdown",start),loadMap()</script></body></html>