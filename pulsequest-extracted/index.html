<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" name=viewport><meta content=yes name=mobile-web-app-capable><meta content=yes name=apple-mobile-web-app-capable><meta content=black-fullscreen name=apple-mobile-web-app-status-bar-style><meta content=landscape name=screen-orientation><title>‚üÅ PulseQuest</title><style>:root{--bg:#0a0e27;--card:#1a1f3a;--text:#e0e7ff;--stroke:#2d3561;--accent:#8b5cf6;--beacon:#fbbf24;--empty:#0f1729}*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:linear-gradient(135deg,#0a0e27 0,#1a1b4b 25%,#2d1b4e 50%,#1a1b4b 75%,#0a0e27 100%);background-size:400% 400%;animation:nebula-flow 20s ease infinite;color:var(--text);overflow:hidden;width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left)}@keyframes nebula-flow{0%,100%{background-position:0 50%}50%{background-position:100% 50%}}body::before{content:'';position:fixed;inset:0;background-image:radial-gradient(2px 2px at 20% 30%,#fff,transparent),radial-gradient(2px 2px at 60% 70%,#fff,transparent),radial-gradient(1px 1px at 50% 50%,#fff,transparent),radial-gradient(1px 1px at 80% 10%,#fff,transparent),radial-gradient(2px 2px at 90% 60%,#fff,transparent),radial-gradient(1px 1px at 33% 80%,#fff,transparent),radial-gradient(1px 1px at 15% 90%,#fff,transparent);background-size:200% 200%;animation:stars-twinkle 3s ease-in-out infinite;pointer-events:none;opacity:.6;z-index:1}@keyframes stars-twinkle{0%,100%{opacity:.6}50%{opacity:.9}}.shell{width:100%;height:100%;display:flex;flex-direction:column;padding:10px;position:relative;z-index:2}.card{flex:1;display:flex;flex-direction:column;background:var(--card);border:1px solid var(--stroke);border-radius:12px;overflow:hidden;position:relative;width:100%;height:100%;min-height:0}.hud{display:flex;align-items:center;justify-content:space-between;padding:12px 20px;border-bottom:1px solid var(--stroke);background:rgba(0,0,0,.3);gap:20px;flex-wrap:wrap}.hud-left{display:flex;align-items:center;gap:16px}.hud-center{display:flex;align-items:center;gap:20px}.title{font-size:clamp(16px, 4vw, 20px);font-weight:800;color:var(--beacon);text-shadow:0 0 10px rgba(251,191,36,.5)}.info{font-size:clamp(12px, 3vw, 14px);color:var(--text)}.stage{flex:1;padding:20px;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;touch-action:none;min-height:0;overflow:hidden}#grid{width:100%;height:auto;max-height:100%;aspect-ratio:14/4;display:grid;grid-template-columns:repeat(14,1fr);grid-template-rows:repeat(4,1fr);gap:clamp(2px,.5vw,6px);padding:clamp(4px,.8vw,8px);background:rgba(10,14,39,.8);backdrop-filter:blur(10px);border:2px solid var(--stroke);border-radius:8px;box-shadow:0 0 30px rgba(139,92,246,.3);min-height:0}.cell{width:100%;height:100%;aspect-ratio:1;border-radius:clamp(2px,.3vw,4px);display:flex;align-items:center;justify-content:center;position:relative;background:linear-gradient(135deg,#0f1729 0,#1a1f3a 100%);border:1px solid rgba(139,92,246,.2)}@media (max-width:374px){.shell{padding:4px}.hud{padding:8px 10px;gap:10px}.hud-center{gap:10px}.stage{padding:8px}.controls-panel{padding:8px 10px}.menu-btn{padding:6px 10px;font-size:14px}}@media (max-width:768px){.shell{padding:6px}.hud{padding:10px 12px}.stage{padding:12px}.controls-panel{padding:10px 12px}}@media (min-width:768px) and (max-width:1023px){.stage{padding:16px}}@media (min-width:1024px){.stage{padding:20px}}@media (min-width:1440px){.stage{padding:24px}#grid{max-width:1200px}}.cell.beacon{background:linear-gradient(135deg,#92400e 0,#78350f 100%);border-color:rgba(251,191,36,.5);box-shadow:0 0 20px rgba(251,191,36,.4)}.cell.wall{background:linear-gradient(135deg,#3f3f46 0,#27272a 100%);border-color:rgba(161,161,170,.3)}.player{font-size:clamp(14px, 3vw, 22px);filter:drop-shadow(0 2px 4px rgba(0, 0, 0, .5))}.icon{font-size:clamp(14px, 3vw, 22px)}.compass{width:clamp(48px,12vw,60px);height:clamp(48px,12vw,60px);background:rgba(10,14,39,.9);border:2px solid rgba(139,92,246,.5);border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 0 20px rgba(139,92,246,.3)}.compass-inner{position:relative;width:75%;height:75%}.compass-arrow{position:absolute;font-size:clamp(10px, 2.5vw, 12px);opacity:.3;transition:opacity .3s,transform .3s}.compass-arrow.active{opacity:1;color:#ffd166;transform:scale(1.3);filter:drop-shadow(0 0 8px #ffd166)}.compass-arrow.n{top:0;left:50%;transform:translateX(-50%)}.compass-arrow.n.active{transform:translateX(-50%) scale(1.3)}.compass-arrow.e{top:50%;right:0;transform:translateY(-50%)}.compass-arrow.e.active{transform:translateY(-50%) scale(1.3)}.compass-arrow.s{bottom:0;left:50%;transform:translateX(-50%)}.compass-arrow.s.active{transform:translateX(-50%) scale(1.3)}.compass-arrow.w{top:50%;left:0;transform:translateY(-50%)}.compass-arrow.w.active{transform:translateY(-50%) scale(1.3)}.drawer{position:absolute;top:0;right:0;bottom:0;width:min(280px,80vw);background:rgba(10,15,30,.98);border-left:1px solid var(--stroke);z-index:1000;transform:translateX(100%);transition:transform .4s cubic-bezier(.16, 1, .3, 1);display:flex;flex-direction:column;backdrop-filter:blur(24px);box-shadow:-20px 0 50px rgba(0,0,0,.8)}.drawer.open{transform:translateX(0)}.drawer-header{padding:24px 20px 10px;display:flex;align-items:center;justify-content:space-between}.drawer h3{font-size:20px;color:var(--beacon);font-weight:800;margin:0}.close-btn{background:rgba(255,255,255,.05);border:none;color:#fff;width:36px;height:36px;border-radius:50%;font-size:24px;cursor:pointer;display:flex;align-items:center;justify-content:center}.settings{flex:1;display:flex;flex-direction:column;gap:14px;padding:20px;overflow-y:auto}.settings label,.settings select{width:100%;text-align:left;font-size:14px;background:linear-gradient(135deg,rgba(255,255,255,.08),rgba(255,255,255,.03));padding:16px;border-radius:12px;border:1px solid var(--stroke);color:var(--text);cursor:pointer;transition:all .2s;font-weight:500}.settings select:hover{background:linear-gradient(135deg,rgba(255,255,255,.12),rgba(255,255,255,.06));border-color:var(--accent);transform:translateY(-1px)}.settings select:focus{outline:0;border-color:var(--accent);box-shadow:0 0 0 3px rgba(108,168,255,.1)}.settings select option{background:#0f1420;color:var(--text);padding:10px}.menu-btn{background:linear-gradient(135deg,rgba(255,255,255,.08),rgba(255,255,255,.03));border:1px solid var(--stroke);color:var(--text);padding:clamp(6px,2vw,8px) clamp(10px,3vw,12px);border-radius:8px;cursor:pointer;font-size:clamp(14px, 3.5vw, 16px);font-weight:600;transition:all .2s;display:inline-flex;align-items:center;gap:6px}.menu-btn:hover{background:linear-gradient(135deg,rgba(255,255,255,.12),rgba(255,255,255,.06));border-color:var(--accent);transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,.3)}.menu-btn:active{transform:translateY(0)}.sonar-blinkers{display:flex;gap:clamp(12px,3vw,16px);padding:clamp(8px,2vw,10px) clamp(16px,4vw,20px);background:rgba(10,14,39,.9);border-radius:99px;border:2px solid rgba(139,92,246,.5)}.sonar-led{width:clamp(20px,5vw,24px);height:clamp(20px,5vw,24px);border-radius:50%;background:rgba(255,255,255,.15);border:2px solid rgba(255,255,255,.3);transition:all .15s;position:relative}.sonar-led::before{content:'';position:absolute;inset:-6px;border-radius:50%;background:radial-gradient(circle,var(--accent) 0,transparent 70%);opacity:0;transition:opacity .15s}.sonar-led.active{background:var(--accent);border-color:var(--accent);box-shadow:0 0 24px var(--accent),inset 0 0 12px rgba(255,255,255,.5)}.sonar-led.active::before{opacity:.7}.sonar-led.long{background:var(--beacon);border-color:var(--beacon);box-shadow:0 0 24px var(--beacon),inset 0 0 12px rgba(255,255,255,.5)}.controls-panel{background:rgba(0,0,0,.4);border-top:1px solid var(--stroke);padding:clamp(10px,3vw,16px) clamp(12px,4vw,20px);display:flex;justify-content:center;gap:clamp(12px,4vw,40px);flex-wrap:wrap}.control-item{display:flex;align-items:center;gap:clamp(6px,2vw,8px);font-size:clamp(11px, 2.5vw, 13px);color:rgba(255,255,255,.8)}.control-key{background:rgba(255,255,255,.1);border:1px solid var(--stroke);border-radius:4px;padding:clamp(3px,1vw,4px) clamp(6px,2vw,8px);font-weight:600;font-size:clamp(10px, 2.5vw, 12px);color:var(--accent);min-width:clamp(50px,12vw,60px);text-align:center}#overlay{position:absolute;inset:0;background:rgba(7,10,22,.95);backdrop-filter:blur(20px);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:100;cursor:pointer}#overlay.hidden{display:none}#overlay h2{font-size:clamp(32px, 10vw, 48px);margin-bottom:10px;color:var(--beacon)}#overlay p{font-size:clamp(12px, 3vw, 14px);color:var(--accent)}#win{position:absolute;inset:0;background:rgba(7,10,22,.95);backdrop-filter:blur(20px);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:100;padding:20px}#win.hidden{display:none}#win h2{font-size:clamp(48px, 12vw, 64px);margin-bottom:20px}#win p{font-size:clamp(14px, 3.5vw, 18px);text-align:center}</style></head><body><div class=shell><div class=card><div class=hud><div class=hud-left><div class=title>‚üÅ PulseQuest</div></div><div class=hud-center><div class=compass><div class=compass-inner><div class="compass-arrow n" id=compass-n>‚ñ≤</div><div class="compass-arrow e" id=compass-e>‚ñ∫</div><div class="compass-arrow s" id=compass-s>‚ñº</div><div class="compass-arrow w" id=compass-w>‚óÄ</div></div></div><div class=sonar-blinkers><div class=sonar-led id=led-left></div><div class=sonar-led id=led-right></div></div></div><div class=info>Pos: <span id=pos>1,1</span> | Dir: <span id=dir>E</span> | Steps: <span id=steps>0</span> <button class=menu-btn onclick=toggleDrawer() style=margin-left:15px>üó∫Ô∏è</button></div></div><div class=stage id=stage><div id=grid></div></div><div class=controls-panel><div class=control-item><span class=control-key>Tap Left</span> <span>Move Forward</span></div><div class=control-item><span class=control-key>Tap Right</span> <span>Turn Right 90¬∞</span></div><div class=control-item><span class=control-key>Hold Both</span> <span>Sonar Scan</span></div><div class=control-item><span class=control-key>W / ‚Üë</span> <span>Move (Desktop)</span></div><div class=control-item><span class=control-key>D / ‚Üí</span> <span>Turn (Desktop)</span></div></div><div class=drawer id=drawer><div class=drawer-header><h3>Settings</h3><button class=close-btn onclick=toggleDrawer()>√ó</button></div><div class=settings><select id=mapSelect onchange=loadMap()><option value=0>Map: Empty</option><option value=1>Map: Simple Maze</option><option value=2>Map: Challenge</option></select></div></div></div></div><div id=overlay><h2>‚üÅ PulseQuest</h2><p>Tap to begin</p></div><div class=hidden id=win><h2>ü•á</h2><p>Treat found! You have saved the world!!</p><div style=margin-top:20px><select id=winMapSelect onchange=loadMapFromWin() style="padding:10px 20px;font-size:14px;border-radius:8px;background:rgba(255,255,255,.1);border:1px solid var(--stroke);color:var(--text);cursor:pointer"><option value=0>Map: Empty</option><option value=1>Map: Simple Maze</option><option value=2>Map: Challenge</option></select></div></div><script>const WIDTH=14,HEIGHT=4,DIR=["N","E","S","W"],DX=[0,1,0,-1],DY=[-1,0,1,0],COMPASS_IDS=["compass-n","compass-e","compass-s","compass-w"],MAPS=["EEEEEEEEEEEEEE,EEEEEEEEEEEEEE,EEEEEEEEEEBEEE,EEEEEEEEEEEEEE","WWWWWWWWWWWWWW,WEEEEWWWEEEEEW,WEWWWWWWEWWWEW,WEEEEEEEEWWBEW","WWWWWWWWWWWWWW,WEEEEWEEEEEEEW,WEWWWWWWEWWBEW,WEEEEEEEEEEEEW"];let map=[],px=1,py=1,pd=1,steps=0,started=!1,beaconX=19,beaconY=5;function parseMap(e){return e.split(",").map(e=>e.split(""))}function getTile(e,t){return t>=0&&t<4&&e>=0&&e<14?map[t][e]:"W"}function render(){const e=document.getElementById("grid");e.innerHTML="";for(let t=0;t<4;t++)for(let n=0;n<14;n++){const o=document.createElement("div"),a=map[t][n];o.className="cell","B"===a?(o.classList.add("beacon"),o.innerHTML='<span class="icon">ü¶¥</span>'):"W"===a&&(o.classList.add("wall"),o.innerHTML='<span class="icon">‚òÑÔ∏è</span>'),n===px&&t===py&&(o.innerHTML='<span class="player">üêï</span>'),e.appendChild(o)}COMPASS_IDS.forEach((e,t)=>{const n=document.getElementById(e);n&&n.classList.toggle("active",t===pd)}),document.getElementById("pos").textContent=`${px},${py}`,document.getElementById("dir").textContent=DIR[pd],document.getElementById("steps").textContent=steps}function moveForward(){if(!started)return;const e=px+DX[pd],t=py+DY[pd];if(e<0||e>=14||t<0||t>=4)return void triggerHaptic([0,100]);const n=getTile(e,t);"W"!==n?(px=e,py=t,steps++,triggerHaptic([0,30]),"B"===n&&(document.getElementById("win").classList.remove("hidden"),triggerHaptic([0,100,100,100,100,150])),render()):triggerHaptic([0,100])}function turnRight(){started&&(pd=(pd+1)%4,triggerHaptic([0,20]),render())}function performScan(){if(!started)return;const e=beaconX-px,t=beaconY-py;let n,o=180*Math.atan2(t,e)/Math.PI-[0,90,180,-90][pd];for(;o>180;)o-=360;for(;o<-180;)o+=360;n=Math.abs(o)<=25?"ahead":Math.abs(o)>=155?"behind":o>0?"right":"left";const a=Math.abs(e)+Math.abs(t);let i;i=a<=1?5:a<=3?4:a<=6?3:a<=10?2:1,performSonarBlinks(n,i)}function isAndroid(){return/Android/i.test(navigator.userAgent)}function supportsVibration(){return"vibrate"in navigator}function triggerHaptic(e){if(isAndroid()&&supportsVibration())try{navigator.vibrate(e)}catch(e){console.log("Vibration failed:",e)}}function performSonarBlinks(e,t){const n=document.getElementById("led-left"),o=document.getElementById("led-right");let a=[];"left"===e?a.push({leds:[n],duration:150,gap:400,haptic:"left"}):"right"===e?a.push({leds:[o],duration:150,gap:400,haptic:"right"}):"ahead"===e?a.push({leds:[n,o],duration:150,gap:400,haptic:"both"}):"behind"===e&&(a.push({leds:[n,o],duration:300,gap:150,long:!0,haptic:"both"}),a.push({leds:[n,o],duration:300,gap:400,long:!0,haptic:"both"}));for(let e=0;e<t;e++){const i=e===t-1;a.push({leds:[n,o],duration:150,gap:i?0:200,haptic:"both"})}let i=0;a.forEach(e=>{setTimeout(()=>{if(e.leds.forEach(t=>{t.classList.add("active"),e.long&&t.classList.add("long")}),"left"===e.haptic)triggerHaptic([0,e.duration]);else if("right"===e.haptic){const t=Math.floor(e.duration/2);triggerHaptic([0,t,30,t-30])}else"both"===e.haptic&&triggerHaptic([0,e.duration]);setTimeout(()=>{e.leds.forEach(t=>{t.classList.remove("active"),e.long&&t.classList.remove("long")})},e.duration)},i),i+=e.duration+e.gap})}function loadMap(){const e=parseInt(document.getElementById("mapSelect").value);map=parseMap(MAPS[e]);for(let e=0;e<4;e++)for(let t=0;t<14;t++)"B"===map[e][t]&&(beaconX=t,beaconY=e);px=1,py=1,pd=1,steps=0,document.getElementById("win").classList.add("hidden"),render()}function loadMapFromWin(){const e=parseInt(document.getElementById("winMapSelect").value);document.getElementById("mapSelect").value=e,loadMap()}function toggleDrawer(){document.getElementById("drawer").classList.toggle("open")}let touchTimeout=null,wasHeld=!1;const stageEl=document.getElementById("stage"),activePointers=new Map;let leftTouch=!1,rightTouch=!1;function showFlash(e,t){const n=document.createElement("div");n.className="input-flash",n.style.left=e+"px",n.style.top=t+"px",document.body.appendChild(n),setTimeout(()=>n.remove(),400)}function updateTouchZones(){const e=stageEl.getBoundingClientRect(),t=e.left+e.width/2;leftTouch=!1,rightTouch=!1,activePointers.forEach(e=>{e.x<t?leftTouch=!0:rightTouch=!0})}function start(){document.getElementById("overlay").classList.add("hidden"),started=!0;const e=document.documentElement;e.requestFullscreen?e.requestFullscreen().catch(e=>console.log("Fullscreen failed:",e)):e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),loadMap()}stageEl.addEventListener("pointerdown",e=>{started&&(e.preventDefault(),stageEl.setPointerCapture(e.pointerId),wasHeld=!1,activePointers.set(e.pointerId,{x:e.clientX,y:e.clientY}),updateTouchZones(),showFlash(e.clientX,e.clientY),leftTouch&&rightTouch&&(clearTimeout(touchTimeout),touchTimeout=setTimeout(()=>{wasHeld=!0,performScan()},300)))},{passive:!1}),stageEl.addEventListener("pointerup",e=>{if(!activePointers.has(e.pointerId))return;try{stageEl.releasePointerCapture(e.pointerId)}catch{}const t=stageEl.getBoundingClientRect(),n=t.left+t.width/2,o=activePointers.get(e.pointerId).x;activePointers.delete(e.pointerId),clearTimeout(touchTimeout),updateTouchZones(),0!==activePointers.size||wasHeld||(o<n?moveForward():turnRight())}),stageEl.addEventListener("pointercancel",e=>{try{stageEl.releasePointerCapture(e.pointerId)}catch{}activePointers.delete(e.pointerId),clearTimeout(touchTimeout),updateTouchZones()}),document.addEventListener("keydown",e=>{"w"===e.key||"ArrowUp"===e.key?moveForward():"d"!==e.key&&"ArrowRight"!==e.key||turnRight()}),document.getElementById("overlay").addEventListener("pointerdown",start),loadMap()</script></body></html>